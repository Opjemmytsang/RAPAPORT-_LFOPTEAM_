<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>RAPAPORT é‘½çŸ³å ±åƒ¹æŸ¥è©¢</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #1a2a6c 0%, #2a5298 100%);
            padding: 15px;
            min-height: 100vh;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .container {
            width: 100%;
            max-width: 500px;
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        header {
            background: linear-gradient(120deg, #1a2a6c, #2a5298);
            color: white;
            padding: 25px 20px;
            text-align: center;
            position: relative;
        }
        
        header::before {
            content: "ğŸ’";
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 40px;
            opacity: 0.15;
        }
        
        h1 {
            font-size: 1.8rem;
            margin-bottom: 8px;
            font-weight: 700;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }
        
        .subtitle {
            font-size: 1rem;
            opacity: 0.9;
            margin-bottom: 5px;
        }
        
        .exchange-rate {
            background: rgba(255, 255, 255, 0.15);
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 14px;
            margin-top: 8px;
            font-weight: 500;
        }
        
        .content {
            padding: 20px;
        }
        
        .input-group {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-field {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 16px;
            display: flex;
            align-items: center;
        }
        
        label i {
            margin-right: 10px;
            font-size: 20px;
            color: #4a6cf7;
        }
        
        input, select {
            width: 100%;
            padding: 15px;
            border: 1px solid #d1d9e6;
            border-radius: 10px;
            font-size: 16px;
            background: #f8fafc;
            appearance: none;
            -webkit-appearance: none;
            transition: all 0.3s ease;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #4a6cf7;
            box-shadow: 0 0 0 3px rgba(74, 108, 247, 0.2);
        }
        
        .button-group {
            text-align: center;
            margin: 25px 0 15px;
        }
        
        button {
            background: linear-gradient(to right, #4a6cf7, #6a5af9);
            color: white;
            border: none;
            padding: 17px 45px;
            font-size: 18px;
            font-weight: 600;
            border-radius: 12px;
            cursor: pointer;
            width: 100%;
            max-width: 300px;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(74, 108, 247, 0.4);
            position: relative;
            overflow: hidden;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(74, 108, 247, 0.5);
        }
        
        button:active {
            transform: translateY(1px);
        }
        
        .result-container {
            background: #f8fafd;
            border-radius: 12px;
            padding: 25px 20px;
            border: 1px solid #e2e8f0;
            margin-top: 15px;
            text-align: center;
        }
        
        #result {
            font-size: 18px;
            line-height: 1.6;
            color: #2d3748;
            min-height: 150px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        #error {
            color: #e53e3e;
            font-size: 15px;
            margin-top: 15px;
            text-align: center;
            min-height: 22px;
            font-weight: 500;
        }
        
        .price-display {
            font-size: 40px;
            font-weight: 700;
            color: #4a6cf7;
            margin: 15px 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .price-note {
            font-size: 16px;
            color: #718096;
            margin-top: 5px;
            font-weight: 500;
        }
        
        .hkd-price {
            font-size: 24px;
            font-weight: 600;
            color: #1a2a6c;
            margin: 10px 0;
            padding: 8px 15px;
            border-radius: 8px;
            background: rgba(26, 42, 108, 0.08);
        }
        
        .discount-price {
            font-size: 32px;
            font-weight: 700;
            color: #2e7d32;
            margin: 10px 0;
            padding: 10px 20px;
            border-radius: 8px;
            background: rgba(46, 125, 50, 0.1);
        }
        
        .discount-label {
            font-size: 16px;
            color: #2e7d32;
            margin-top: 5px;
            font-weight: 600;
        }
        
        .details {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            width: 100%;
            max-width: 400px;
        }
        
        .detail-item {
            background: rgba(74, 108, 247, 0.08);
            padding: 12px 15px;
            border-radius: 10px;
            font-weight: 500;
            min-width: 140px;
        }
        
        .current-value {
            font-size: 28px;
            font-weight: 700;
            color: #1a2a6c;
            margin-top: 25px;
            padding: 12px 25px;
            background: linear-gradient(to right, #4a6cf7, #6a5af9);
            color: white;
            border-radius: 10px;
            display: inline-block;
            box-shadow: 0 4px 10px rgba(74, 108, 247, 0.3);
        }
        
        .value-label {
            font-size: 16px;
            font-weight: 600;
            color: #4a5568;
            margin-top: 8px;
        }
        
        .note {
            margin-top: 25px;
            padding: 15px;
            background: #edf2f7;
            border-radius: 10px;
            font-size: 14px;
            color: #4a5568;
            line-height: 1.6;
            border-left: 4px solid #4a6cf7;
        }
        
        footer {
            text-align: center;
            padding: 20px 15px;
            color: #718096;
            font-size: 14px;
            border-top: 1px solid #e2e8f0;
        }
        
        @media (max-width: 400px) {
            header {
                padding: 20px 15px;
            }
            
            h1 {
                font-size: 1.6rem;
            }
            
            button {
                padding: 15px;
                font-size: 16px;
            }
            
            .price-display, .current-value, .discount-price {
                font-size: 32px;
            }
            
            .detail-item {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>RAPAPORT é‘½çŸ³å ±åƒ¹æŸ¥è©¢</h1>
            <div class="subtitle">å¸‚å ´é‘½çŸ³åƒ¹æ ¼è¨ˆç®—å·¥å…·</div>
            <div class="exchange-rate">1 USD = 7.85 HKD</div>
        </header>
        
        <div class="content">
            <div class="input-group">
                <div class="input-field">
                    <label for="carat"><i>ğŸ’</i> ä¸»çŸ³ä»½æ•¸ (ct)</label>
                    <input type="number" id="carat" step="0.01" placeholder="ä¾‹å¦‚: 1.25" min="0.30" max="3.99" inputmode="decimal">
                </div>
                
                <div class="input-field">
                    <label for="color"><i>ğŸ¨</i> é¡è‰² (Color)</label>
                    <select id="color">
                        <option value="">è«‹é¸æ“‡é¡è‰²</option>
                        <option>D</option><option>E</option><option>F</option>
                        <option>G</option><option>H</option><option>I</option>
                        <option>J</option><option>K</option><option>L</option><option>M</option>
                    </select>
                </div>
                
                <div class="input-field">
                    <label for="clarity"><i>ğŸ”</i> æ·¨åº¦ (Clarity)</label>
                    <select id="clarity">
                        <option value="">è«‹é¸æ“‡æ·¨åº¦</option>
                        <option>IF</option><option>VVS1</option><option>VVS2</option>
                        <option>VS1</option><option>VS2</option><option>SI1</option><option>SI2</option>
                    </select>
                </div>
                
                <div class="input-field">
                    <label for="year"><i>ğŸ“…</i> å¹´ä»½</label>
                    <select id="year">
                        <option value="2023">2023</option>
                        <option value="2024" selected>2024</option>
                        <option value="2025">2025</option>
                    </select>
                </div>
                
                <div class="input-field">
                    <label for="discount"><i>ğŸ’°</i> Discount (%)</label>
                    <input type="number" id="discount" step="1" placeholder="ä¾‹å¦‚: 30" min="0" max="100" value="0">
                </div>
            </div>
            
            <div class="button-group">
                <button id="searchBtn">æŸ¥è©¢é‘½çŸ³å ±åƒ¹</button>
            </div>
            
            <div class="result-container">
                <div id="result">
                    <div style="color: #a0aec0; padding: 30px;">
                        è«‹è¼¸å…¥é‘½çŸ³åƒæ•¸å¾Œé»æ“ŠæŸ¥è©¢æŒ‰éˆ•
                    </div>
                </div>
                <div id="error"></div>
            </div>
            
            <div class="note">
                <p><strong>ä½¿ç”¨èªªæ˜ï¼š</strong> æœ¬å·¥å…·åŸºæ–¼RAPAPORTåœ‹éš›é‘½çŸ³å ±åƒ¹è¡¨æ•¸æ“šï¼Œå ±åƒ¹çµæœé¡¯ç¤ºç‚ºç¾æ™‚å¸‚å ´é‘½çŸ³ç´„åƒ¹ã€‚ç¾å€¼åƒ¹ç‚ºæŠ˜æ‰£å¾Œåƒ¹æ ¼ã€‚</p>
            </div>
        </div>
        
        <footer>
            <p>Â© 2023-2025 RAPAPORTé‘½çŸ³å ±åƒ¹æŸ¥è©¢ç³»çµ± | å…­ç¦å°ˆç”¨ç‰ˆ</p>
        </footer>
    </div>

    <script>
        // RAPAPORTé’»çŸ³æŠ¥ä»·æ•°æ®ï¼ˆå·²ä¿®æ­£é”™è¯¯ï¼‰
        const RAPAPORT = {
            "2023": {
                "0.30-0.39": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[39,35,30,26,24,20,18], "E":[34,31,27,24,22,19,17], "F":[31,28,25,22,21,18,16], "G":[28,26,23,21,20,17,15], "H":[25,23,21,20,18,16,14], "I":[22,20,19,18,17,15,13], "J":[20,18,17,16,15,14,12], "K":[18,17,16,15,14,13,12], "L":[17,16,15,14,13,12,11], "M":[16,15,14,13,12,11,10] } },
                "0.40-0.49": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[46,41,36,32,28,25,21], "E":[39,35,31,28,25,22,19], "F":[36,33,29,26,24,21,18], "G":[32,29,26,24,22,20,17], "H":[28,26,24,22,21,19,16], "I":[25,23,21,20,19,17,15], "J":[22,20,19,18,17,16,14], "K":[20,19,18,17,16,15,13], "L":[19,18,17,16,15,14,12], "M":[18,17,16,15,14,13,11] } },
                "0.50-0.69": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[67,58,47,41,36,29,23], "E":[54,49,41,36,32,27,22], "F":[46,43,37,33,30,25,20], "G":[39,36,32,29,26,22,18], "H":[32,30,27,25,23,20,16], "I":[27,25,23,21,20,17,14], "J":[23,21,20,19,18,15,13], "K":[20,19,18,17,16,14,12], "L":[19,18,17,16,15,13,11], "M":[18,17,16,15,14,12,10] } },
                "0.70-0.89": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[85,74,61,53,45,37,30], "E":[70,64,53,47,41,34,28], "F":[60,56,48,42,38,31,26], "G":[50,46,41,37,33,28,24], "H":[40,37,34,31,28,24,20], "I":[34,32,29,27,24,21,18], "J":[28,26,24,22,20,18,16], "K":[24,22,20,19,18,16,14], "L":[22,20,19,18,17,15,13], "M":[20,19,18,17,16,14,12] } },
                "0.90-0.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[128,113,86,74,62,51,41], "E":[108,96,75,65,54,44,36], "F":[96,87,70,60,50,40,33], "G":[77,70,60,52,45,37,30], "H":[60,55,48,42,37,31,26], "I":[51,46,41,36,32,27,23], "J":[41,37,33,30,27,24,21], "K":[34,31,28,26,23,21,19], "L":[28,25,23,21,19,18,16], "M":[25,22,20,18,17,15,14] } },
                "1.00-1.49": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[195,164,130,112,95,75,60], "E":[153,136,114,97,81,65,53], "F":[130,117,98,84,70,57,46], "G":[98,90,80,69,59,49,40], "H":[72,67,61,55,48,42,35], "I":[60,55,50,45,40,35,30], "J":[50,45,41,38,35,32,28], "K":[41,37,34,32,30,28,25], "L":[35,32,30,28,26,24,22], "M":[30,28,26,24,22,20,19] } },
                "1.50-1.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[265,236,190,165,140,110,90], "E":[230,210,170,145,125,100,80], "F":[200,185,155,130,110,90,70], "G":[160,150,130,110,95,80,65], "H":[130,120,105,95,85,70,60], "I":[105,95,85,75,70,60,50], "J":[85,75,70,65,60,50,45], "K":[70,65,60,55,50,45,40], "L":[60,55,50,45,42,38,35], "M":[50,47,44,41,38,35,32] } },
                "2.00-2.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[420,365,305,270,230,185,150], "E":[360,320,275,240,200,165,135], "F":[320,290,255,220,190,155,125], "G":[270,245,220,190,170,140,115], "H":[220,200,180,160,145,120,100], "I":[180,165,150,135,125,110,90], "J":[145,135,125,115,105,95,85], "K":[120,110,100,95,90,80,70], "L":[100,90,85,80,75,70,65], "M":[85,80,75,70,65,60,55] } },
                "3.00-3.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[700,610,540,470,390,310,260], "E":[580,530,470,410,350,280,240], "F":[520,480,420,370,320,260,220], "G":[430,400,360,320,280,230,200], "H":[340,310,280,250,230,190,160], "I":[280,260,240,220,200,170,145], "J":[230,210,195,180,165,150,130], "K":[190,175,160,150,140,125,110], "L":[150,140,130,120,110,105,95], "M":[125,115,105,100,90,85,75] } }
            },
            "2024": {
                "0.30-0.39": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[35,32,27,23,21,18,16], "E":[31,28,24,21,19,17,15], "F":[28,25,22,20,18,16,14], "G":[25,23,21,19,18,15,14], "H":[22,21,19,18,17,15,13], "I":[20,18,17,16,15,14,12], "J":[18,16,15,14,13,12,11], "K":[16,15,14,13,12,11,10], "L":[15,14,13,12,11,10,10], "M":[14,13,12,11,10,9,9] } },
                "0.40-0.49": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[41,37,32,29,25,22,19], "E":[36,32,28,25,23,20,18], "F":[33,30,26,24,22,19,17], "G":[29,27,24,22,20,18,16], "H":[25,23,21,20,19,17,15], "I":[22,20,19,18,17,15,14], "J":[20,18,17,16,15,14,13], "K":[18,17,16,15,14,13,12], "L":[17,16,15,14,13,12,11], "M":[16,15,14,13,12,11,10] } },
                "0.50-0.69": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[60,52,42,37,32,26,21], "E":[49,44,37,33,29,24,20], "F":[42,39,34,30,27,22,18], "G":[36,33,29,26,24,20,17], "H":[29,27,25,23,21,18,15], "I":[25,23,21,20,18,16,14], "J":[21,19,18,17,16,14,12], "K":[18,17,16,15,14,13,11], "L":[17,16,15,14,13,12,10], "M":[16,15,14,13,12,11,9] } },
                "0.70-0.89": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[77,67,55,48,41,34,28], "E":[63,57,47,41,36,30,25], "F":[55,51,44,38,34,28,24], "G":[46,43,38,35,31,26,22], "H":[37,34,31,29,26,23,20], "I":[31,29,27,25,23,20,18], "J":[26,24,22,21,19,17,16], "K":[22,21,19,18,17,16,14], "L":[20,19,18,17,16,15,13], "M":[18,17,16,15,14,13,12] } },
                "0.90-0.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[115,103,79,67,56,46,37], "E":[97,87,68,58,49,40,33], "F":[88,80,64,54,47,38,31], "G":[71,65,56,49,44,36,29], "H":[55,51,46,42,38,33,28], "I":[47,43,39,36,33,29,25], "J":[38,35,32,30,27,25,22], "K":[32,30,28,26,24,23,21], "L":[27,25,23,22,20,19,18], "M":[24,22,20,19,17,16,15] } },
                "1.00-1.49": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[158,130,104,87,73,57,46], "E":[127,112,94,78,65,52,42], "F":[108,97,83,70,59,48,39], "G":[83,77,68,60,53,45,37], "H":[62,57,54,50,47,41,34], "I":[53,48,45,42,39,36,31], "J":[44,40,37,34,32,29,27], "K":[36,33,30,28,27,25,23], "L":[31,28,26,24,23,21,20], "M":[27,25,23,22,20,18,17] } },
                "1.50-1.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[208,188,155,134,120,95,78], "E":[189,172,142,122,109,88,70], "F":[165,152,130,113,102,83,66], "G":[137,126,112,98,88,77,62], "H":[109,100,90,80,73,68,56], "I":[88,81,72,67,62,58,52], "J":[74,66,60,56,52,49,44], "K":[63,56,51,46,43,41,38], "L":[53,47,42,39,37,35,33], "M":[46,41,38,36,33,31,29] } },
                "2.00-2.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[328,278,236,204,175,141,112], "E":[272,244,211,189,159,131,104], "F":[246,220,194,174,150,122,97], "G":[206,184,164,149,134,111,91], "H":[166,150,134,124,114,103,85], "I":[135,120,109,100,92,85,77], "J":[108,98,90,83,76,68,62], "K":[90,82,75,69,62,56,52], "L":[78,70,65,60,53,49,45], "M":[67,62,56,53,47,44,41] } },
                "3.00-3.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[548,460,408,348,294,234,198], "E":[452,420,370,320,264,208,183], "F":[406,375,334,294,244,194,169], "G":[336,314,279,244,208,179,154], "H":[271,250,224,204,183,158,133], "I":[220,204,188,174,159,139,119], "J":[174,164,148,139,128,118,108], "K":[144,134,124,119,108,102,96], "L":[116,110,106,102,94,89,81], "M":[94,90,86,82,78,74,66] } }
            },
            "2025": {
                "0.30-0.39": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[31,25,22,20,18,16,15], "E":[26,23,20,18,17,15,14], "F":[23,21,19,17,16,14,13], "G":[20,18,17,16,15,14,13], "H":[17,16,15,15,14,13,12], "I":[15,14,13,13,12,12,11], "J":[13,12,11,11,10,10,10], "K":[12,11,10,9,9,9,9], "L":[11,10,9,8,8,8,8], "M":[10,9,9,8,8,8,7] } },
                "0.40-0.49": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[35,29,25,23,21,19,17], "E":[29,26,23,21,20,18,16], "F":[26,24,22,20,19,17,15], "G":[23,21,20,19,18,16,14], "H":[20,18,17,17,16,15,13], "I":[18,16,15,15,14,13,12], "J":[16,14,13,13,12,12,11], "K":[14,13,12,11,11,10,10], "L":[13,12,11,10,10,9,9], "M":[12,11,10,9,9,9,8] } },
                "0.50-0.69": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[55,46,36,30,27,23,19], "E":[44,40,33,28,25,21,18], "F":[38,35,30,26,24,20,17], "G":[32,29,26,24,23,19,16], "H":[26,24,23,22,21,18,15], "I":[23,21,20,19,18,16,14], "J":[19,17,16,15,14,13,12], "K":[16,15,14,13,12,12,11], "L":[15,14,13,12,11,11,10], "M":[14,13,12,11,10,10,9] } },
                "0.70-0.89": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[70,58,45,39,34,30,26], "E":[57,51,42,37,32,28,24], "F":[50,46,40,35,30,26,22], "G":[42,39,35,32,28,24,21], "H":[34,31,29,27,25,22,19], "I":[29,27,25,24,22,19,17], "J":[24,22,20,19,18,17,15], "K":[22,20,18,17,16,15,14], "L":[20,18,16,15,14,13,12], "M":[18,16,14,13,12,12,11] } },
                "0.90-0.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[104,94,70,60,52,44,36], "E":[90,81,65,55,48,40,32], "F":[82,75,60,51,45,37,29], "G":[65,60,52,46,42,34,27], "H":[50,46,42,39,36,31,26], "I":[45,41,37,35,32,28,24], "J":[37,34,31,29,27,25,23], "K":[32,30,28,26,24,23,21], "L":[27,25,23,22,20,19,18], "M":[24,22,20,19,17,16,15] } },
                "1.00-1.49": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[160,128,102,87,73,57,46], "E":[125,111,93,79,66,53,43], "F":[107,97,84,72,60,49,40], "G":[82,77,70,62,54,46,38], "H":[61,58,55,52,48,42,35], "I":[52,49,46,43,40,37,32], "J":[43,40,37,34,33,30,28], "K":[36,33,31,29,28,26,24], "L":[31,28,26,25,24,22,21], "M":[27,25,24,23,21,19,18] } },
                "1.50-1.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[210,187,154,134,120,96,78], "E":[188,173,143,122,110,89,71], "F":[164,153,132,114,103,84,67], "G":[136,126,114,99,89,78,63], "H":[108,100,91,81,74,69,57], "I":[87,81,72,68,63,59,53], "J":[74,67,61,57,53,50,45], "K":[63,56,51,47,44,42,39], "L":[53,47,43,40,38,36,34], "M":[46,41,39,36,34,32,30] } },
                "2.00-2.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[330,275,235,205,175,141,113], "E":[270,245,210,190,160,132,105], "F":[245,220,195,175,150,123,98], "G":[205,185,165,150,135,112,92], "H":[165,150,135,125,115,104,86], "I":[135,120,110,100,93,86,78], "J":[109,99,91,84,76,69,63], "K":[91,83,76,70,63,57,53], "L":[78,71,66,61,54,50,46], "M":[68,63,57,54,48,45,42] } },
                "3.00-3.99": { headers: ["IF","VVS1","VVS2","VS1","VS2","SI1","SI2"], 
                    rows: { "D":[550,460,410,350,295,235,200], "E":[450,420,370,320,265,210,185], "F":[405,375,335,295,245,195,170], "G":[335,315,280,245,210,180,155], "H":[270,250,225,205,185,160,135], "I":[220,205,190,175,160,140,120], "J":[175,165,150,140,130,120,110], "K":[145,135,125,120,110,103,97], "L":[117,111,107,103,95,90,82], "M":[95,91,87,83,79,75,67] } }
            }
        };

        // åŒ¯ç‡å¸¸æ•¸
        const EXCHANGE_RATE = 7.85;

        // è·å–å…‹æ‹‰èŒƒå›´
        function getCaratRange(carat) {
            const ranges = Object.keys(RAPAPORT["2023"]);
            for (let r of ranges) {
                const [min, max] = r.split('-').map(parseFloat);
                if (carat >= min && carat <= max) return r;
            }
            return null;
        }

        // æŸ¥æ‰¾é’»çŸ³ä»·æ ¼
        function searchPrice() {
            const year = document.getElementById("year").value;
            const caratInput = document.getElementById("carat").value;
            const color = document.getElementById("color").value;
            const clarity = document.getElementById("clarity").value;
            const discountInput = document.getElementById("discount").value;
            
            const resultDiv = document.getElementById("result");
            const errorDiv = document.getElementById("error");
            
            // æ¸…ç©ºä¹‹å‰çš„ç»“æœ
            resultDiv.innerHTML = "";
            errorDiv.innerHTML = "";
            
            // éªŒè¯è¾“å…¥
            if (!caratInput) {
                errorDiv.innerHTML = "âŒ è«‹è¼¸å…¥ä¸»çŸ³ä»½æ•¸";
                return;
            }
            
            const carat = parseFloat(caratInput);
            if (isNaN(carat)) {
                errorDiv.innerHTML = "âŒ ä¸»çŸ³ä»½æ•¸å¿…é ˆæ˜¯æ•¸å­—";
                return;
            }
            
            if (carat < 0.3 || carat > 3.99) {
                errorDiv.innerHTML = "âŒ ä¸»çŸ³ä»½æ•¸å¿…é ˆåœ¨0.30-3.99å…‹æ‹‰ä¹‹é–“";
                return;
            }
            
            if (!color) {
                errorDiv.innerHTML = "âŒ è«‹é¸æ“‡é¡è‰²";
                return;
            }
            
            if (!clarity) {
                errorDiv.innerHTML = "âŒ è«‹é¸æ“‡æ·¨åº¦";
                return;
            }
            
            let discountValue = 0;
            if (discountInput) {
                discountValue = parseFloat(discountInput);
                if (isNaN(discountValue)) {
                    errorDiv.innerHTML = "âŒ æŠ˜æ‰£å¿…é ˆæ˜¯æ•¸å­—";
                    return;
                }
                
                if (discountValue < 0 || discountValue > 100) {
                    errorDiv.innerHTML = "âŒ æŠ˜æ‰£å¿…é ˆåœ¨0-100ä¹‹é–“";
                    return;
                }
            }
            
            // è·å–å…‹æ‹‰èŒƒå›´
            const range = getCaratRange(carat);
            if (!range) {
                errorDiv.innerHTML = "âŒ ç„¡ç¬¦åˆçš„ä»½æ•¸å€é–“";
                return;
            }
            
            // è·å–å¹´ä»½æ•°æ®
            const yearData = RAPAPORT[year];
            if (!yearData) {
                errorDiv.innerHTML = "âŒ è©²å¹´ä»½æ•¸æ“šä¸å­˜åœ¨";
                return;
            }
            
            // è·å–èŒƒå›´æ•°æ®
            const rangeData = yearData[range];
            if (!rangeData) {
                errorDiv.innerHTML = "âŒ è©²ä»½æ•¸å€é–“æ•¸æ“šä¸å­˜åœ¨";
                return;
            }
            
            // è·å–é¢œè‰²æ•°æ®
            const colorData = rangeData.rows[color];
            if (!colorData) {
                errorDiv.innerHTML = "âŒ è©²é¡è‰²æ•¸æ“šä¸å­˜åœ¨";
                return;
            }
            
            // è·å–å‡€åº¦ç´¢å¼•
            const clarityIndex = rangeData.headers.indexOf(clarity);
            if (clarityIndex === -1) {
                errorDiv.innerHTML = "âŒ è©²æ·¨åº¦æ•¸æ“šä¸å­˜åœ¨";
                return;
            }
            
            // è·å–ä»·æ ¼
            const price = colorData[clarityIndex];
            
            // è®¡ç®—æŠ˜æ‰£åä»·æ ¼
            const discountedPrice = Math.round(price * 100 * (1 - discountValue / 100));
            
            // è®¡ç®—æ¸¯å…ƒä»·æ ¼
            const priceHKD = Math.round(price * 100 * EXCHANGE_RATE);
            const discountedPriceHKD = Math.round(discountedPrice * EXCHANGE_RATE);
            
            // æ˜¾ç¤ºç»“æœ
            resultDiv.innerHTML = `
                <div class="price-display">US$${discountedPrice.toLocaleString()}</div>
                <div class="price-note">(å¤§ç´„å¸‚å ´åƒ¹å€¼)</div>
                <div class="hkd-price">ç´„ HKD ${priceHKD.toLocaleString()}</div>
                
                ${discountValue > 0 ? `
                <div class="discount-price">US$${discountedPrice.toLocaleString()}</div>
                <div class="discount-label">æŠ˜æ‰£å¾Œåƒ¹æ ¼ (${discountValue}% off)</div>
                <div class="hkd-price">ç´„ HKD ${discountedPriceHKD.toLocaleString()}</div>
                ` : ''}
                
                <div class="details">
                    <div class="detail-item">
                        <div>ğŸ“… å¹´ä»½</div>
                        <div><strong>${year}</strong></div>
                    </div>
                    <div class="detail-item">
                        <div>ğŸ’ ä»½æ•¸</div>
                        <div><strong>${carat} ct</strong></div>
                    </div>
                    <div class="detail-item">
                        <div>ğŸ¨ é¡è‰²</div>
                        <div><strong>${color}</strong></div>
                    </div>
                    <div class="detail-item">
                        <div>ğŸ§¼ æ·¨åº¦</div>
                        <div><strong>${clarity}</strong></div>
                    </div>
                </div>
                
                <div class="current-value">US$${discountedPrice.toLocaleString()}</div>
                <div class="value-label">ç¾å€¼åƒ¹ç´„</div>
                <div class="hkd-price">ç´„ HKD ${discountedPriceHKD.toLocaleString()}</div>
            `;
        }

        // æ·»åŠ æŒ‰é’®ç‚¹å‡»äº‹ä»¶ç›‘å¬
        document.getElementById("searchBtn").addEventListener("click", searchPrice);
        
        // æ·»åŠ é”®ç›˜äº‹ä»¶ç›‘å¬ï¼ŒæŒ‰Enteré”®ä¹Ÿå¯æŸ¥è¯¢
        document.addEventListener("keypress", function(e) {
            if (e.key === "Enter") {
                searchPrice();
            }
        });
    </script>
</body>
</html>




