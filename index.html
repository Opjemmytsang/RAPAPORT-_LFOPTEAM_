<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>RAPAPORT é‘½çŸ³å ±åƒ¹æŸ¥è©¢</title>
<style>
       * {
           box-sizing: border-box;
           margin: 0;
           padding: 0;
           -webkit-tap-highlight-color: transparent;
           font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
       }
       body {
           background: linear-gradient(135deg, #1a2a6c 0%, #2a5298 100%);
           padding: 15px;
           min-height: 100vh;
           color: #333;
           display: flex;
           justify-content: center;
           align-items: center;
       }
       .container {
           width: 100%;
           max-width: 500px;
           background: white;
           border-radius: 16px;
           box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
           overflow: hidden;
       }
       header {
           background: linear-gradient(120deg, #1a2a6c, #2a5298);
           color: white;
           padding: 25px 20px;
           text-align: center;
           position: relative;
       }
       header::before {
           content: "ğŸ’";
           position: absolute;
           top: 15px;
           right: 20px;
           font-size: 40px;
           opacity: 0.15;
       }
       h1 {
           font-size: 1.8rem;
           margin-bottom: 8px;
           font-weight: 700;
           text-shadow: 0 1px 3px rgba(0,0,0,0.2);
       }
       .subtitle {
           font-size: 1rem;
           opacity: 0.9;
           margin-bottom: 5px;
       }
       .exchange-rate {
           background: rgba(255, 255, 255, 0.15);
           display: inline-block;
           padding: 5px 12px;
           border-radius: 20px;
           font-size: 14px;
           margin-top: 8px;
           font-weight: 500;
       }
       .content { padding: 20px; }
       .input-group { display: grid; grid-template-columns: 1fr; gap: 15px; margin-bottom: 20px; }
       .input-field { margin-bottom: 15px; }
       label {
           display: flex; align-items: center;
           margin-bottom: 8px;
           font-weight: 600;
           color: #2c3e50;
           font-size: 16px;
       }
       label i { margin-right: 10px; font-size: 20px; color: #4a6cf7; }
       input, select {
           width: 100%;
           padding: 15px;
           border: 1px solid #d1d9e6;
           border-radius: 10px;
           font-size: 16px;
           background: #f8fafc;
           transition: all 0.3s ease;
       }
       input:focus, select:focus {
           outline: none;
           border-color: #4a6cf7;
           box-shadow: 0 0 0 3px rgba(74, 108, 247, 0.2);
       }
       .button-group { text-align: center; margin: 25px 0 15px; }
       button {
           background: linear-gradient(to right, #4a6cf7, #6a5af9);
           color: white;
           border: none;
           padding: 17px 45px;
           font-size: 18px;
           font-weight: 600;
           border-radius: 12px;
           cursor: pointer;
           width: 100%;
           max-width: 300px;
           transition: all 0.3s ease;
           box-shadow: 0 5px 15px rgba(74, 108, 247, 0.4);
       }
       button:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(74, 108, 247, 0.5); }
       button:active { transform: translateY(1px); }
       .result-container {
           background: #f8fafd;
           border-radius: 12px;
           padding: 25px 20px;
           border: 1px solid #e2e8f0;
           margin-top: 15px;
           text-align: center;
       }
       #result { font-size: 18px; line-height: 1.6; color: #2d3748; min-height: 150px; }
       #error { color: #e53e3e; font-size: 15px; margin-top: 15px; font-weight: 500; }
       .price-display { font-size: 40px; font-weight: 700; color: #4a6cf7; margin: 15px 0; }
       .price-note, .discount-label { font-size: 16px; color: #2e7d32; margin-top: 5px; font-weight: 500; }
       .hkd-price { font-size: 24px; font-weight: 600; color: #1a2a6c; margin: 10px 0; padding: 8px 15px; border-radius: 8px; background: rgba(26, 42, 108, 0.08); }
       .details { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; margin-top: 20px; width: 100%; max-width: 400px; }
       .detail-item { background: rgba(74, 108, 247, 0.08); padding: 12px 15px; border-radius: 10px; font-weight: 500; min-width: 140px; }
       footer { text-align: center; padding: 20px 15px; color: #718096; font-size: 14px; border-top: 1px solid #e2e8f0; }
       
       /* å„ªåŒ–çµæœä»‹é¢ */
       .result-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           background: linear-gradient(120deg, #f8fafd, #eef2ff);
           border-radius: 12px;
           padding: 15px;
           margin-bottom: 20px;
           border: 1px solid #e0e7ff;
           box-shadow: 0 4px 12px rgba(74, 108, 247, 0.1);
       }
       .diamond-info {
           text-align: left;
       }
       .diamond-info h3 {
           font-size: 1.1rem;
           color: #1a2a6c;
           margin-bottom: 8px;
       }
       .diamond-spec {
           font-size: 0.9rem;
           color: #4a5568;
           display: flex;
           flex-wrap: wrap;
           gap: 8px;
       }
       .spec-item {
           background: rgba(74, 108, 247, 0.1);
           padding: 4px 10px;
           border-radius: 20px;
           font-size: 0.85rem;
       }
       .diamond-icon {
           font-size: 2.5rem;
           color: #4a6cf7;
           opacity: 0.8;
       }
       .price-summary {
           background: linear-gradient(135deg, #4a6cf7, #6a5af9);
           border-radius: 12px;
           padding: 25px 15px;
           color: white;
           margin: 20px auto;
           max-width: 90%;
           box-shadow: 0 6px 18px rgba(74, 108, 247, 0.3);
       }
       .price-title {
           font-size: 1.1rem;
           margin-bottom: 15px;
           display: flex;
           align-items: center;
           justify-content: center;
           gap: 8px;
       }
       .price-title i {
           font-size: 1.4rem;
       }
       .usd-price {
           font-size: 2.5rem;
           font-weight: 700;
           margin: 10px 0;
           text-shadow: 0 2px 4px rgba(0,0,0,0.2);
       }
       .hkd-equivalent {
           font-size: 1.2rem;
           opacity: 0.9;
           margin-top: 5px;
       }
       .price-per-carat {
           background: rgba(255, 255, 255, 0.15);
           border-radius: 10px;
           padding: 10px;
           margin-top: 15px;
           font-size: 0.9rem;
       }
       .price-breakdown {
           background: #f8fafd;
           border-radius: 12px;
           padding: 20px 15px;
           border: 1px solid #e2e8f0;
           margin-top: 20px;
       }
       .breakdown-title {
           font-size: 1.1rem;
           color: #1a2a6c;
           margin-bottom: 15px;
           text-align: center;
           display: flex;
           align-items: center;
           justify-content: center;
           gap: 8px;
       }
       .breakdown-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
           gap: 12px;
           margin-top: 15px;
       }
       .breakdown-card {
           background: white;
           border-radius: 10px;
           padding: 15px 10px;
           box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
           border: 1px solid #edf2f7;
           transition: transform 0.3s ease;
       }
       .breakdown-card:hover {
           transform: translateY(-3px);
           box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
       }
       .breakdown-card h4 {
           font-size: 0.85rem;
           color: #4a5568;
           margin-bottom: 8px;
       }
       .breakdown-value {
           font-size: 1.1rem;
           font-weight: 600;
           color: #1a2a6c;
       }
       .breakdown-value.usd {
           color: #4a6cf7;
       }
       .breakdown-value.hkd {
           color: #2e7d32;
       }
       .discount-badge {
           background: linear-gradient(135deg, #2e7d32, #43a047);
           color: white;
           padding: 3px 12px;
           border-radius: 20px;
           font-size: 0.8rem;
           font-weight: 600;
           display: inline-block;
           margin-top: 10px;
           box-shadow: 0 2px 5px rgba(46, 125, 50, 0.3);
       }
       .placeholder {
           color: #a0aec0;
           padding: 30px;
           text-align: center;
       }
       .placeholder i {
           font-size: 2.5rem;
           display: block;
           margin-bottom: 15px;
           opacity: 0.5;
       }
       @media (max-width: 400px) {
           h1 { font-size: 1.6rem; }
           button { padding: 15px; font-size: 16px; }
           .price-display { font-size: 32px; }
           .detail-item { min-width: 100%; }
           .usd-price { font-size: 2rem; }
           .breakdown-grid { grid-template-columns: 1fr; }
       }
</style>
</head>
<body>
<div class="container">
<header>
<h1>RAPAPORT é‘½çŸ³å ±åƒ¹æŸ¥è©¢</h1>
<div class="subtitle">å¸‚å ´é‘½çŸ³åƒ¹æ ¼è¨ˆç®—å·¥å…·</div>
<div class="exchange-rate">1 USD = 7.85 HKD</div>
</header>
<div class="content">
<div class="input-group">
<div class="input-field">
<label for="carat"><i>ğŸ’</i> ä¸»çŸ³ä»½æ•¸ (ct)</label>
<input type="number" id="carat" step="0.01" placeholder="ä¾‹å¦‚: 1.25" min="0.30" max="3.99" inputmode="decimal">
</div>
<div class="input-field">
<label for="color"><i>ğŸ¨</i> é¡è‰² (Color)</label>
<select id="color">
<option value="">è«‹é¸æ“‡é¡è‰²</option>
<option>D</option><option>E</option><option>F</option>
<option>G</option><option>H</option><option>I</option>
<option>J</option><option>K</option><option>L</option><option>M</option>
</select>
</div>
<div class="input-field">
<label for="clarity"><i>ğŸ”</i> æ·¨åº¦ (Clarity)</label>
<select id="clarity">
<option value="">è«‹é¸æ“‡æ·¨åº¦</option>
<option>IF</option><option>VVS1</option><option>VVS2</option>
<option>VS1</option><option>VS2</option><option>SI1</option><option>SI2</option>
</select>
</div>
<div class="input-field">
<label for="year"><i>ğŸ“…</i> å¹´ä»½</label>
<select id="year">
<option value="2023">2023</option>
<option value="2024" selected>2024</option>
<option value="2025">2025</option>
</select>
</div>
<div class="input-field">
<label for="discount"><i>ğŸ’°</i> æŠ˜æ‰£ (%)</label>
<input type="number" id="discount" step="1" placeholder="ä¾‹å¦‚: 30" min="0" max="100" value="0">
</div>
</div>
<div class="button-group">
<button id="searchBtn">æŸ¥è©¢é‘½çŸ³å ±åƒ¹</button>
</div>
<div class="result-container">
<div id="result">
    <div class="placeholder">
        <i>ğŸ’</i>
        è«‹è¼¸å…¥é‘½çŸ³åƒæ•¸å¾Œé»æ“ŠæŸ¥è©¢æŒ‰éˆ•
    </div>
</div>
<div id="error"></div>
</div>
</div>
<footer>Â© 2023-2025 RAPAPORTé‘½çŸ³å ±åƒ¹æŸ¥è©¢ç³»çµ± | å…­ç¦å°ˆç”¨ç‰ˆ</footer>
</div>
<script>
        // RAPAPORTé’»çŸ³æŠ¥ä»·æ•°æ®
const RAPAPORT = {
    "2023": {
        "0.30-0.39": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [38, 32, 28, 24, 21, 18, 15], 
                "E": [33, 30, 25, 22, 20, 17, 14], 
                "F": [30, 27, 23, 21, 19, 16, 13], 
                "G": [25, 23, 21, 20, 18, 15, 12], 
                "H": [22, 21, 20, 19, 17, 14, 12], 
                "I": [19, 18, 17, 16, 15, 13, 11], 
                "J": [17, 16, 15, 14, 13, 12, 10], 
                "K": [15, 14, 13, 12, 11, 10, 9], 
                "L": [14, 13, 12, 11, 10, 9, 8], 
                "M": [12, 11, 10, 9, 9, 8, 7] 
            } 
        },
        "0.40-0.49": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [44, 36, 32, 29, 25, 20, 17], 
                "E": [37, 34, 30, 27, 24, 19, 16], 
                "F": [34, 31, 28, 25, 23, 18, 15], 
                "G": [30, 28, 26, 24, 22, 17, 14], 
                "H": [26, 24, 23, 22, 20, 16, 14], 
                "I": [22, 21, 20, 19, 18, 15, 13], 
                "J": [19, 18, 17, 16, 15, 14, 12], 
                "K": [17, 16, 15, 14, 13, 12, 11], 
                "L": [16, 15, 14, 13, 12, 11, 10], 
                "M": [15, 14, 13, 12, 11, 10, 9] 
            } 
        },
        "0.50-0.69": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [65, 53, 43, 36, 32, 27, 21], 
                "E": [52, 48, 39, 33, 30, 25, 20], 
                "F": [46, 43, 36, 30, 28, 24, 19], 
                "G": [38, 35, 31, 28, 26, 23, 18], 
                "H": [32, 30, 28, 26, 24, 21, 17], 
                "I": [27, 25, 24, 23, 21, 19, 16], 
                "J": [23, 21, 20, 19, 18, 16, 15], 
                "K": [20, 18, 17, 16, 15, 14, 13], 
                "L": [18, 17, 16, 15, 14, 13, 12], 
                "M": [17, 16, 15, 14, 13, 12, 11] 
            } 
        },
        "0.70-0.89": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [91, 73, 61, 51, 44, 36, 30], 
                "E": [74, 67, 56, 48, 41, 33, 28], 
                "F": [66, 62, 52, 45, 39, 31, 26], 
                "G": [55, 51, 46, 42, 37, 29, 25], 
                "H": [46, 43, 40, 37, 33, 27, 23], 
                "I": [39, 36, 34, 31, 28, 24, 21], 
                "J": [34, 32, 30, 27, 24, 22, 19], 
                "K": [30, 28, 26, 24, 22, 20, 18], 
                "L": [27, 25, 23, 21, 20, 18, 16], 
                "M": [25, 23, 21, 19, 18, 16, 15] 
            } 
        },
        "0.90-0.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [122, 108, 89, 71, 60, 52, 42], 
                "E": [109, 99, 83, 65, 56, 48, 38], 
                "F": [100, 91, 77, 61, 53, 45, 35], 
                "G": [85, 76, 65, 56, 49, 41, 33], 
                "H": [70, 64, 57, 51, 46, 38, 31], 
                "I": [60, 56, 50, 46, 41, 34, 29], 
                "J": [50, 48, 44, 40, 36, 31, 27], 
                "K": [44, 41, 37, 34, 31, 28, 25], 
                "L": [36, 34, 31, 28, 26, 24, 22], 
                "M": [31, 29, 27, 25, 23, 21, 19] 
            } 
        },
        "1.00-1.49": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [212, 160, 129, 108, 87, 67, 54], 
                "E": [157, 136, 116, 99, 80, 62, 50], 
                "F": [138, 124, 107, 92, 75, 58, 47], 
                "G": [108, 101, 93, 82, 70, 54, 44], 
                "H": [86, 82, 76, 70, 64, 49, 41], 
                "I": [71, 67, 63, 58, 52, 45, 38], 
                "J": [59, 55, 51, 47, 43, 38, 34], 
                "K": [50, 47, 43, 40, 37, 33, 30], 
                "L": [42, 39, 36, 33, 31, 28, 26], 
                "M": [36, 34, 32, 30, 28, 25, 23] 
            } 
        },
        "1.50-1.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [252, 212, 174, 152, 131, 101, 83], 
                "E": [209, 193, 160, 139, 121, 94, 76], 
                "F": [183, 171, 148, 127, 112, 88, 71], 
                "G": [151, 140, 126, 112, 101, 82, 67], 
                "H": [125, 115, 105, 98, 88, 75, 63], 
                "I": [102, 96, 87, 82, 75, 65, 59], 
                "J": [85, 79, 73, 69, 64, 56, 51], 
                "K": [74, 68, 64, 60, 55, 48, 44], 
                "L": [64, 59, 55, 51, 47, 42, 39], 
                "M": [55, 51, 47, 44, 41, 38, 35] 
            } 
        },
        "2.00-2.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [405, 330, 270, 230, 190, 145, 116], 
                "E": [310, 280, 245, 210, 175, 136, 107], 
                "F": [265, 245, 220, 195, 165, 126, 100], 
                "G": [225, 205, 185, 165, 145, 115, 94], 
                "H": [185, 170, 155, 140, 125, 106, 88], 
                "I": [152, 137, 123, 113, 102, 92, 82], 
                "J": [125, 113, 103, 96, 88, 80, 73], 
                "K": [105, 96, 85, 79, 73, 68, 63], 
                "L": [89, 82, 74, 69, 64, 61, 57], 
                "M": [77, 71, 65, 61, 57, 54, 50] 
            } 
        },
        "3.00-3.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [660, 560, 480, 400, 330, 235, 200], 
                "E": [530, 495, 430, 365, 300, 210, 185], 
                "F": [450, 425, 370, 325, 275, 195, 170], 
                "G": [380, 355, 315, 270, 235, 180, 155], 
                "H": [300, 280, 250, 230, 200, 165, 135], 
                "I": [245, 225, 205, 185, 165, 145, 120], 
                "J": [195, 180, 165, 150, 135, 125, 110], 
                "K": [160, 145, 135, 125, 117, 107, 97], 
                "L": [128, 121, 114, 108, 100, 92, 82], 
                "M": [105, 99, 93, 87, 82, 77, 67] 
            } 
        }
    },
    "2024": {
        "0.30-0.39": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [28, 24, 22, 21, 19, 18, 16], 
                "E": [25, 22, 20, 19, 18, 17, 15], 
                "F": [22, 20, 19, 18, 17, 16, 14], 
                "G": [20, 19, 18, 17, 16, 15, 13], 
                "H": [19, 18, 17, 16, 15, 14, 12], 
                "I": [16, 15, 14, 14, 13, 12, 11], 
                "J": [14, 13, 12, 12, 11, 10, 10], 
                "K": [13, 12, 11, 10, 10, 9, 9], 
                "L": [12, 11, 10, 9, 9, 8, 8], 
                "M": [10, 9, 9, 8, 8, 8, 7] 
            } 
        },
        "0.40-0.49": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [33, 27, 25, 23, 22, 21, 18], 
                "E": [28, 25, 23, 22, 21, 20, 17], 
                "F": [26, 24, 22, 21, 20, 19, 16], 
                "G": [24, 22, 21, 20, 19, 18, 15], 
                "H": [22, 20, 19, 18, 17, 16, 14], 
                "I": [20, 19, 18, 17, 16, 15, 13], 
                "J": [17, 16, 15, 14, 14, 13, 12], 
                "K": [15, 14, 13, 12, 12, 11, 11], 
                "L": [14, 13, 12, 11, 11, 10, 10], 
                "M": [13, 12, 11, 10, 10, 10, 9] 
            } 
        },
        "0.50-0.69": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [53, 44, 36, 32, 29, 26, 21], 
                "E": [44, 40, 33, 30, 27, 24, 20], 
                "F": [39, 36, 30, 27, 25, 23, 19], 
                "G": [33, 30, 27, 25, 24, 22, 18], 
                "H": [27, 25, 24, 23, 22, 20, 17], 
                "I": [24, 22, 21, 20, 19, 18, 16], 
                "J": [21, 19, 18, 17, 16, 15, 14], 
                "K": [18, 17, 16, 15, 14, 13, 12], 
                "L": [16, 15, 14, 13, 12, 12, 11], 
                "M": [15, 14, 13, 12, 11, 11, 10] 
            } 
        },
        "0.70-0.89": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [70, 58, 49, 44, 38, 33, 29], 
                "E": [59, 54, 46, 41, 35, 31, 27], 
                "F": [54, 50, 43, 38, 33, 29, 25], 
                "G": [45, 42, 38, 35, 31, 27, 24], 
                "H": [38, 35, 32, 30, 28, 25, 22], 
                "I": [33, 30, 28, 26, 24, 22, 19], 
                "J": [28, 26, 24, 22, 21, 19, 17], 
                "K": [25, 23, 21, 20, 19, 17, 16], 
                "L": [23, 21, 19, 18, 17, 15, 14], 
                "M": [21, 19, 17, 16, 15, 14, 13] 
            } 
        },
        "0.90-0.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [104, 94, 78, 63, 55, 49, 40], 
                "E": [95, 86, 72, 58, 51, 45, 36], 
                "F": [87, 80, 67, 54, 48, 42, 33], 
                "G": [71, 66, 58, 49, 44, 38, 31], 
                "H": [59, 55, 49, 45, 41, 35, 29], 
                "I": [50, 46, 42, 39, 36, 32, 27], 
                "J": [42, 39, 36, 33, 30, 28, 25], 
                "K": [35, 32, 30, 28, 26, 25, 23], 
                "L": [30, 28, 26, 24, 22, 21, 20], 
                "M": [25, 23, 21, 20, 19, 18, 17] 
            } 
        },
        "1.00-1.49": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [160, 128, 108, 96, 80, 65, 52], 
                "E": [125, 111, 98, 87, 72, 60, 48], 
                "F": [110, 100, 89, 79, 67, 56, 45], 
                "G": [85, 80, 74, 69, 60, 52, 43], 
                "H": [68, 64, 61, 58, 54, 47, 40], 
                "I": [58, 55, 52, 49, 45, 42, 36], 
                "J": [49, 45, 41, 38, 36, 34, 32], 
                "K": [40, 37, 35, 33, 31, 29, 27], 
                "L": [35, 32, 30, 28, 27, 25, 24], 
                "M": [29, 27, 26, 25, 24, 22, 21] 
            } 
        },
        "1.50-1.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [210, 187, 154, 134, 120, 96, 78], 
                "E": [188, 173, 143, 122, 110, 89, 71], 
                "F": [164, 153, 132, 114, 103, 84, 67], 
                "G": [136, 126, 114, 99, 89, 78, 63], 
                "H": [110, 102, 93, 83, 76, 71, 59], 
                "I": [90, 84, 76, 70, 65, 61, 55], 
                "J": [76, 69, 63, 59, 56, 52, 47], 
                "K": [66, 59, 54, 50, 47, 45, 41], 
                "L": [56, 50, 46, 43, 41, 39, 36], 
                "M": [49, 44, 41, 38, 36, 34, 33] 
            } 
        },
        "2.00-2.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [330, 275, 235, 205, 175, 141, 113], 
                "E": [270, 245, 210, 190, 160, 132, 105], 
                "F": [245, 220, 195, 175, 150, 123, 98], 
                "G": [205, 185, 165, 150, 135, 112, 92], 
                "H": [165, 150, 135, 125, 115, 104, 86], 
                "I": [135, 120, 110, 100, 93, 87, 78], 
                "J": [109, 99, 91, 84, 78, 72, 66], 
                "K": [91, 83, 76, 70, 66, 61, 56], 
                "L": [78, 71, 66, 61, 57, 53, 49], 
                "M": [68, 63, 57, 54, 51, 48, 45] 
            } 
        },
        "3.00-3.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [565, 475, 410, 350, 295, 235, 200], 
                "E": [450, 420, 370, 320, 265, 210, 185], 
                "F": [405, 375, 335, 295, 245, 195, 170], 
                "G": [335, 315, 280, 245, 210, 180, 155], 
                "H": [270, 250, 225, 205, 185, 160, 135], 
                "I": [220, 205, 190, 175, 160, 140, 120], 
                "J": [175, 165, 150, 140, 130, 120, 110], 
                "K": [145, 135, 125, 120, 110, 103, 97], 
                "L": [117, 111, 107, 103, 95, 90, 82], 
                "M": [95, 91, 87, 83, 79, 75, 67] 
            } 
        }
    },
    "2025": {
        "0.30-0.39": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [31, 25, 22, 20, 18, 16, 15], 
                "E": [26, 23, 20, 18, 17, 15, 14], 
                "F": [23, 21, 19, 17, 16, 14, 13], 
                "G": [20, 18, 17, 16, 15, 14, 13], 
                "H": [17, 16, 15, 15, 14, 13, 12], 
                "I": [15, 14, 13, 13, 12, 12, 11], 
                "J": [13, 12, 11, 11, 10, 10, 10], 
                "K": [12, 11, 10, 9, 9, 9, 9], 
                "L": [11, 10, 9, 8, 8, 8, 8], 
                "M": [10, 9, 9, 8, 8, 8, 7] 
            } 
        },
        "0.40-0.49": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [35, 29, 25, 23, 21, 19, 17], 
                "E": [29, 26, 23, 21, 20, 18, 16], 
                "F": [26, 24, 22, 20, 19, 17, 15], 
                "G": [23, 21, 20, 19, 18, 16, 14], 
                "H": [20, 18, 17, 17, 16, 15, 13], 
                "I": [18, 16, 15, 15, 14, 13, 12], 
                "J": [16, 14, 13, 13, 12, 12, 11], 
                "K": [14, 13, 12, 11, 11, 10, 10], 
                "L": [13, 12, 11, 10, 10, 9, 9], 
                "M": [12, 11, 10, 9, 9, 9, 8] 
            } 
        },
        "0.50-0.69": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [55, 46, 36, 30, 27, 23, 19], 
                "E": [44, 40, 33, 28, 25, 21, 18], 
                "F": [38, 35, 30, 26, 24, 20, 17], 
                "G": [32, 29, 26, 24, 23, 19, 16], 
                "H": [26, 24, 23, 22, 21, 18, 15], 
                "I": [23, 21, 20, 19, 18, 16, 14], 
                "J": [19, 17, 16, 15, 14, 13, 12], 
                "K": [16, 15, 14, 13, 12, 12, 11], 
                "L": [15, 14, 13, 12, 11, 11, 10], 
                "M": [14, 13, 12, 11, 10, 10, 9] 
            } 
        },
        "0.70-0.89": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [70, 58, 45, 39, 34, 30, 26], 
                "E": [57, 51, 42, 37, 32, 28, 24], 
                "F": [50, 46, 40, 35, 30, 26, 22], 
                "G": [42, 39, 35, 32, 28, 24, 21], 
                "H": [34, 31, 29, 27, 25, 22, 19], 
                "I": [29, 27, 25, 24, 22, 19, 17], 
                "J": [24, 22, 20, 19, 18, 17, 15], 
                "K": [22, 20, 18, 17, 16, 15, 14], 
                "L": [20, 18, 16, 15, 14, 13, 12], 
                "M": [18, 16, 14, 13, 12, 12, 11] 
            } 
        },
        "0.90-0.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [104, 94, 70, 60, 52, 44, 36], 
                "E": [90, 81, 65, 55, 48, 40, 32], 
                "F": [82, 75, 60, 51, 45, 37, 29], 
                "G": [65, 60, 52, 46, 42, 34, 27], 
                "H": [50, 46, 42, 39, 36, 31, 26], 
                "I": [45, 41, 37, 35, 32, 28, 24], 
                "J": [37, 34, 31, 29, 27, 25, 23], 
                "K": [32, 30, 28, 26, 24, 23, 21], 
                "L": [27, 25, 23, 22, 20, 19, 18], 
                "M": [24, 22, 20, 19, 17, 16, 15] 
            } 
        },
        "1.00-1.49": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [160, 128, 102, 87, 73, 57, 46], 
                "E": [125, 111, 93, 79, 66, 53, 43], 
                "F": [107, 97, 84, 72, 60, 49, 40], 
                "G": [82, 77, 70, 62, 54, 46, 38], 
                "H": [61, 58, 55, 52, 48, 42, 35], 
                "I": [52, 49, 46, 43, 40, 37, 32], 
                "J": [43, 40, 37, 34, 33, 30, 28], 
                "K": [36, 33, 31, 29, 28, 26, 24], 
                "L": [31, 28, 26, 25, 24, 22, 21], 
                "M": [27, 25, 24, 23, 21, 19, 18] 
            } 
        },
        "1.50-1.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [210, 187, 154, 134, 120, 96, 78], 
                "E": [188, 173, 143, 122, 110, 89, 71], 
                "F": [164, 153, 132, 114, 103, 84, 67], 
                "G": [136, 126, 114, 99, 89, 78, 63], 
                "H": [108, 100, 91, 81, 74, 69, 57], 
                "I": [87, 81, 72, 68, 63, 59, 53], 
                "J": [74, 67, 61, 57, 53, 50, 45], 
                "K": [63, 56, 51, 47, 44, 42, 39], 
                "L": [53, 47, 43, 40, 38, 36, 34], 
                "M": [46, 41, 39, 36, 34, 32, 30] 
            } 
        },
        "2.00-2.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [330, 275, 235, 205, 175, 141, 113], 
                "E": [270, 245, 210, 190, 160, 132, 105], 
                "F": [245, 220, 195, 175, 150, 123, 98], 
                "G": [205, 185, 165, 150, 135, 112, 92], 
                "H": [165, 150, 135, 125, 115, 104, 86], 
                "I": [135, 120, 110, 100, 93, 86, 78], 
                "J": [109, 99, 91, 84, 76, 69, 63], 
                "K": [91, 83, 76, 70, 63, 57, 53], 
                "L": [78, 71, 66, 61, 54, 50, 46], 
                "M": [68, 63, 57, 54, 48, 45, 42] 
            } 
        },
        "3.00-3.99": { headers: ["IF", "VVS1", "VVS2", "VS1", "VS2", "SI1", "SI2"], 
            rows: { 
                "D": [550, 460, 410, 350, 295, 235, 200], 
                "E": [450, 420, 370, 320, 265, 210, 185], 
                "F": [405, 375, 335, 295, 245, 195, 170], 
                "G": [335, 315, 280, 245, 210, 180, 155], 
                "H": [270, 250, 225, 205, 185, 160, 135], 
                "I": [220, 205, 190, 175, 160, 140, 120], 
                "J": [175, 165, 150, 140, 130, 120, 110], 
                "K": [145, 135, 125, 120, 110, 103, 97], 
                "L": [117, 111, 107, 103, 95, 90, 82], 
                "M": [95, 91, 87, 83, 79, 75, 67] 
            } 
        }
    }
};
  const EXCHANGE_RATE = 7.85;

        function getCaratRange(carat) {
            return Object.keys(RAPAPORT['2024']).find(r => {
                const [min, max] = r.split('-').map(parseFloat);
                return carat >= min && carat <= max;
            });
        }

        function searchPrice() {
            const year    = document.getElementById('year').value;
            const carat   = parseFloat(document.getElementById('carat').value || 0);
            const color   = document.getElementById('color').value;
            const clarity = document.getElementById('clarity').value;
            const discount= parseFloat(document.getElementById('discount').value || 0);
            const result  = document.getElementById('result');
            const error   = document.getElementById('error');
            result.innerHTML = '';
            error.textContent = '';

            if (!carat || !color || !clarity) {
                error.textContent = 'âŒ è«‹ç¢ºå¯¦è¼¸å…¥æ‰€æœ‰åƒæ•¸';
                return;
            }
            if (isNaN(carat) || carat < 0.3 || carat > 3.99) {
                error.textContent = 'âŒ ä¸»çŸ³ä»½æ•¸éœ€ä»‹æ–¼ 0.30-3.99'; return;
            }
            if (isNaN(discount) || discount < 0 || discount > 100) {
                error.textContent = 'âŒ æŠ˜æ‰£éœ€ä»‹æ–¼ 0-100%'; return;
            }

            const range = getCaratRange(carat);
            const data  = RAPAPORT[year]?.[range];
            if (!data) { error.textContent = 'âŒ æ‰¾ä¸åˆ°å°æ‡‰æ•¸æ“š'; return; }

            const idx      = data.headers.indexOf(clarity);
            const perCtArr = data.rows[color];
            if (idx < 0 || !perCtArr) { error.textContent = 'âŒ é¡è‰²æˆ–æ·¨åº¦ç„¡å°æ‡‰'; return; }

            // 1. RAPAPORT åƒ¹éŒ¢ (USD per ct)
            const rapUSD = perCtArr[idx] * 100;
            // 2. æŠ˜å¾Œæ¯å…‹æ‹‰ USD
            const pCtsUSD = Math.round(rapUSD * (1 - discount / 100));
            // 3. Amount US$
            const amtUSD = parseFloat((pCtsUSD * carat).toFixed(2));
            // 4. Price/Cts. @HKD
            const pCtsHKD = parseFloat((pCtsUSD * EXCHANGE_RATE).toFixed(2));
            // 5. Amount HK$
            const amtHKD  = parseFloat((amtUSD * EXCHANGE_RATE).toFixed(2));

            // æ ¼å¼åŒ–æ•¸å­—ï¼ˆåƒåˆ†ä½ï¼‰
            const formatNumber = num => num.toLocaleString('en-US', { 
                minimumFractionDigits: 2, 
                maximumFractionDigits: 2 
            });

            result.innerHTML = `
            <div class="result-header">
                <div class="diamond-info">
                    <h3>é‘½çŸ³è¦æ ¼è©³æƒ…</h3>
                    <div class="diamond-spec">
                        <div class="spec-item">${carat} å…‹æ‹‰</div>
                        <div class="spec-item">${color} è‰²</div>
                        <div class="spec-item">${clarity} æ·¨åº¦</div>
                        <div class="spec-item">${year} å¹´å ±åƒ¹</div>
                    </div>
                </div>
                <div class="diamond-icon">ğŸ’</div>
            </div>
            
            <div class="price-summary">
                <div class="price-title">
                    <i>ğŸ’°</i> æŠ˜æ‰£å¾Œç¸½åƒ¹æ ¼
                </div>
                <div class="usd-price">US$${formatNumber(amtUSD)}</div>
                <div class="hkd-equivalent">ç´„ HK$${formatNumber(amtHKD)}</div>
                
                ${discount > 0 ? 
                    `<div class="discount-badge">å·²æ‡‰ç”¨ ${discount}% æŠ˜æ‰£</div>` : 
                    `<div class="price-per-carat">æ¯å…‹æ‹‰åƒ¹æ ¼: US$${formatNumber(pCtsUSD)}</div>`
                }
            </div>
            
            <div class="price-breakdown">
                <div class="breakdown-title">
                    <i>ğŸ“Š</i> åƒ¹æ ¼æ˜ç´°
                </div>
                <div class="breakdown-grid">
                    <div class="breakdown-card">
                        <h4>RAPAPORT åƒ¹éŒ¢</h4>
                        <div class="breakdown-value">US$${formatNumber(rapUSD)}</div>
                        <div>æ¯å…‹æ‹‰</div>
                    </div>
                    <div class="breakdown-card">
                        <h4>Price/Cts. @USD</h4>
                        <div class="breakdown-value usd">US$${formatNumber(pCtsUSD)}</div>
                        <div>æŠ˜å¾Œæ¯å…‹æ‹‰</div>
                    </div>
                    <div class="breakdown-card">
                        <h4>Amount US$</h4>
                        <div class="breakdown-value usd">US$${formatNumber(amtUSD)}</div>
                        <div>ç¸½åƒ¹ (ç¾å…ƒ)</div>
                    </div>
                    <div class="breakdown-card">
                        <h4>Price/Cts. @HKD</h4>
                        <div class="breakdown-value hkd">HK$${formatNumber(pCtsHKD)}</div>
                        <div>æŠ˜å¾Œæ¯å…‹æ‹‰</div>
                    </div>
                    <div class="breakdown-card">
                        <h4>Amount HK$</h4>
                        <div class="breakdown-value hkd">HK$${formatNumber(amtHKD)}</div>
                        <div>ç¸½åƒ¹ (æ¸¯å¹£)</div>
                    </div>
                </div>
            </div>`;
        }

        document.getElementById('searchBtn').addEventListener('click', searchPrice);
        document.addEventListener('keypress', e => e.key === 'Enter' && searchPrice());
    </script>
</body>
</html>
